# 测试文档

## 测试概述

本项目包含以下类型的测试:

1. 单元测试 - 测试单个组件和功能
2. 集成测试 - 测试组件间的交互
3. 端到端测试 - 测试完整的业务流程

## 测试工具

### TestingUtils

`TestingUtils` 是一个用于简化测试的工具类,提供以下功能:

1. 配置管理
   - 加载测试配置
   - 加载测试账户
   - 获取网络配置

2. 合约交互
   - 获取合约地址
   - 创建合约实例
   - 管理合约状态

3. 测试数据
   - 生成测试数据
   - 缓存测试数据
   - 验证测试数据

4. 指标记录
   - 记录测试指标
   - 记录测试事件
   - 生成测试报告

## 测试用例

### 房产流程测试

测试房产注册和审批流程:

1. 注册房产
   - 验证输入参数
   - 检查事件触发
   - 验证状态更新

2. 审批房产
   - 验证权限
   - 检查状态转换
   - 验证事件触发

### 代币流程测试

测试代币创建和转账流程:

1. 代币创建
   - 验证代币参数
   - 检查白名单
   - 验证余额

2. 代币转账
   - 验证转账金额
   - 检查余额更新
   - 验证事件触发

### 用户流程测试

测试用户操作流程:

1. 用户注册
   - 验证用户信息
   - 检查权限设置
   - 验证状态更新

2. 用户操作
   - 验证操作权限
   - 检查状态变化
   - 验证事件触发

## 测试环境

### 配置

测试环境配置位于 `frontend-tests/config/` 目录:

1. `test.config.js` - 测试主配置
2. `test.accounts.js` - 测试账户配置
3. `test.network.js` - 测试网络配置

### 数据

测试数据管理:

1. 测试数据生成
   - 使用 `generateTestData` 方法
   - 支持自定义选项
   - 自动生成唯一标识

2. 测试数据缓存
   - 使用 `cacheTestData` 方法
   - 支持过期时间
   - 自动清理过期数据

## 运行测试

### 单个测试

运行特定的测试用例:

```bash
npm run test:property
npm run test:token
npm run test:user
```

### 所有测试

运行所有测试用例:

```bash
npm run test
```

### 测试报告

生成测试报告:

```bash
npm run test:report
```

## 测试覆盖率

### 覆盖率要求

- 语句覆盖率: > 80%
- 分支覆盖率: > 70%
- 函数覆盖率: > 90%
- 行覆盖率: > 80%

### 覆盖率报告

生成覆盖率报告:

```bash
npm run test:coverage
```

## 最佳实践

1. 测试组织
   - 按功能模块组织测试
   - 使用清晰的测试描述
   - 保持测试独立性

2. 测试数据
   - 使用测试工具生成数据
   - 避免硬编码数据
   - 及时清理测试数据

3. 错误处理
   - 测试异常情况
   - 验证错误信息
   - 检查错误恢复

4. 性能测试
   - 测试响应时间
   - 检查资源使用
   - 验证并发处理 