# XG0004: Monitor模块与共享模块集成

## 任务概述

该任务旨在将监控模块（monitor）与项目共享模块（shared）完全集成，确保整个项目使用统一的组件、配置和工具，减少代码重复并提高可维护性。

## 发现的问题

1. **区块链连接冗余**: Monitor模块实现了自己的区块链连接逻辑，没有使用`shared/utils/blockchain.js`或`shared/utils/web3Provider.js`
2. **事件监听重复实现**: Monitor模块使用自己的事件监听器实现，而非使用`shared/utils/eventListener.js`
3. **ABI管理分离**: Monitor模块维护了自己的`monitor/src/contracts/index.js`文件，而没有使用`shared/utils/getAbis.js`
4. **配置管理不一致**: Monitor模块使用自己的配置逻辑，没有使用`shared/config`

## 实施计划

### 1. 集成区块链连接

- 重构`monitor/src/utils/ethereum.js`，使用`shared/utils/blockchain.js`或`shared/utils/web3Provider.js`
- 确保对WebSocket连接的支持，特别是对于实时事件监听

### 2. 集成事件监听

- 重构`monitor/src/utils/eventListener.js`，使用`shared/utils/eventListener.js`
- 确保支持监控模块特定的事件处理逻辑

### 3. 集成ABI管理

- 删除`monitor/src/contracts/index.js`
- 更新代码使用`shared/utils/getAbis.js`获取合约ABI
- 调整`monitor/scripts/update-abis.js`脚本，使其更新到共享ABI文件

### 4. 集成配置管理

- 重构`monitor/src/config/index.js`使用`shared/config`
- 保留监控模块特定的配置选项，但确保基础配置（如网络设置、合约地址等）来自共享配置

## 实施顺序

1. 从配置管理开始，因为其他组件依赖于配置
2. 然后集成ABI管理
3. 接着集成区块链连接
4. 最后集成事件监听

## 预期成果

- 减少代码重复和维护负担
- 确保配置一致性，避免不同模块之间的配置不同步
- 简化未来的更新，一次更改即可应用到所有模块
- 提高整个系统的可靠性和稳定性 